<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 distributed lag models | Time Series Forecasting</title>
  <meta name="description" content="7 distributed lag models | Time Series Forecasting" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7 distributed lag models | Time Series Forecasting" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 distributed lag models | Time Series Forecasting" />
  
  
  

<meta name="author" content="Katherine Wilson" />


<meta name="date" content="2022-03-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rainfall.html"/>
<link rel="next" href="granger-causality.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#decomposition-models"><i class="fa fa-check"></i><b>1.1</b> Decomposition Models</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#model-assumptions"><i class="fa fa-check"></i><b>1.2</b> Model assumptions</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.3</b> Examples</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#example"><i class="fa fa-check"></i><b>1.3.1</b> Example</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#example-1"><i class="fa fa-check"></i><b>1.3.2</b> Example</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#example-2"><i class="fa fa-check"></i><b>1.3.3</b> Example</a></li>
<li class="chapter" data-level="1.3.4" data-path="index.html"><a href="index.html#example-3"><i class="fa fa-check"></i><b>1.3.4</b> Example</a></li>
<li class="chapter" data-level="1.3.5" data-path="index.html"><a href="index.html#example-4"><i class="fa fa-check"></i><b>1.3.5</b> Example</a></li>
<li class="chapter" data-level="1.3.6" data-path="index.html"><a href="index.html#example-5"><i class="fa fa-check"></i><b>1.3.6</b> Example</a></li>
<li class="chapter" data-level="1.3.7" data-path="index.html"><a href="index.html#example-6"><i class="fa fa-check"></i><b>1.3.7</b> Example</a></li>
<li class="chapter" data-level="1.3.8" data-path="index.html"><a href="index.html#example-7"><i class="fa fa-check"></i><b>1.3.8</b> Example</a></li>
<li class="chapter" data-level="1.3.9" data-path="index.html"><a href="index.html#example-8"><i class="fa fa-check"></i><b>1.3.9</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multiple-regression-models.html"><a href="multiple-regression-models.html"><i class="fa fa-check"></i><b>2</b> multiple regression models</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="multiple-regression-models.html"><a href="multiple-regression-models.html#additivie-decomposition-model-with-a-fourth-degree-polynomial-trend"><i class="fa fa-check"></i><b>2.0.1</b> additivie decomposition model with a fourth-degree polynomial trend</a></li>
<li class="chapter" data-level="2.0.2" data-path="multiple-regression-models.html"><a href="multiple-regression-models.html#additive-decomposition-model-with-cosine-and-sine-seasonal-dummies-and-inclusion-of-an-intercept"><i class="fa fa-check"></i><b>2.0.2</b> Additive decomposition model with cosine and sine seasonal dummies and inclusion of an intercept</a></li>
<li class="chapter" data-level="2.0.3" data-path="multiple-regression-models.html"><a href="multiple-regression-models.html#australian-beer"><i class="fa fa-check"></i><b>2.0.3</b> Australian beer</a></li>
<li class="chapter" data-level="2.1" data-path="multiple-regression-models.html"><a href="multiple-regression-models.html#ontario-gas"><i class="fa fa-check"></i><b>2.1</b> Ontario gas</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>3</b> interactions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="interactions.html"><a href="interactions.html#example-9"><i class="fa fa-check"></i><b>3.1</b> Example</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="interactions.html"><a href="interactions.html#interaction"><i class="fa fa-check"></i><b>3.1.1</b> Interaction</a></li>
<li class="chapter" data-level="3.1.2" data-path="interactions.html"><a href="interactions.html#example-10"><i class="fa fa-check"></i><b>3.1.2</b> example</a></li>
<li class="chapter" data-level="3.1.3" data-path="interactions.html"><a href="interactions.html#durbin-watson-statistic"><i class="fa fa-check"></i><b>3.1.3</b> Durbin-Watson statistic</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="interactions.html"><a href="interactions.html#weekly-garbage-deposites"><i class="fa fa-check"></i><b>3.2</b> Weekly Garbage Deposites</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="interactions.html"><a href="interactions.html#simple-model"><i class="fa fa-check"></i><b>3.2.1</b> Simple model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="interactions.html"><a href="interactions.html#code"><i class="fa fa-check"></i><b>3.3</b> Code</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="interactions.html"><a href="interactions.html#model-3"><i class="fa fa-check"></i><b>3.3.1</b> model 3</a></li>
<li class="chapter" data-level="3.3.2" data-path="interactions.html"><a href="interactions.html#estimated-trends-calculating-the-interaction-terms"><i class="fa fa-check"></i><b>3.3.2</b> Estimated Trends (calculating the interaction terms)</a></li>
<li class="chapter" data-level="3.3.3" data-path="interactions.html"><a href="interactions.html#visualizing-three-trends"><i class="fa fa-check"></i><b>3.3.3</b> Visualizing Three Trends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spectral-density.html"><a href="spectral-density.html"><i class="fa fa-check"></i><b>4</b> spectral density</a></li>
<li class="chapter" data-level="5" data-path="periodogram.html"><a href="periodogram.html"><i class="fa fa-check"></i><b>5</b> periodogram</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="periodogram.html"><a href="periodogram.html#spectral"><i class="fa fa-check"></i><b>5.0.1</b> Spectral</a></li>
<li class="chapter" data-level="5.0.2" data-path="periodogram.html"><a href="periodogram.html#multiplicative"><i class="fa fa-check"></i><b>5.0.2</b> Multiplicative</a></li>
<li class="chapter" data-level="5.0.3" data-path="periodogram.html"><a href="periodogram.html#next-model"><i class="fa fa-check"></i><b>5.0.3</b> next model</a></li>
<li class="chapter" data-level="5.0.4" data-path="periodogram.html"><a href="periodogram.html#getting-seasonal-index-esetimation-from-model-3"><i class="fa fa-check"></i><b>5.0.4</b> getting seasonal index esetimation from model 3</a></li>
<li class="chapter" data-level="5.0.5" data-path="periodogram.html"><a href="periodogram.html#smoothing-technique"><i class="fa fa-check"></i><b>5.0.5</b> smoothing technique</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rainfall.html"><a href="rainfall.html"><i class="fa fa-check"></i><b>6</b> rainfall</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rainfall.html"><a href="rainfall.html#last-example-on-decomposition-model"><i class="fa fa-check"></i><b>6.1</b> last example on decomposition model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="distributed-lag-models.html"><a href="distributed-lag-models.html"><i class="fa fa-check"></i><b>7</b> distributed lag models</a></li>
<li class="chapter" data-level="8" data-path="granger-causality.html"><a href="granger-causality.html"><i class="fa fa-check"></i><b>8</b> Granger causality</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series Forecasting</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="distributed-lag-models" class="section level1" number="7">
<h1><span class="header-section-number">7</span> distributed lag models</h1>
<p>Let y be a dependent variable and x an independent variable. The model</p>
<p><span class="math display">\[
y = \alpha +\sum_{k=0}^{\infty}\beta_kx_{t-k} +\epsilon_t
\]</span></p>
<p>is called a distributed lag model. The effect of the IV on the DV is distributed over a number of lags (e.g., y is sales and x is advertising).</p>
<p>Weighted sum of the value of the X’s at time T and at previous times. Number of terms in the sum is infinite. Current and past advertising influences sales today. The x’s are being lagged. X_t - 1,2, etc. When k=0, then we have X_t.</p>
<p>A special case (geometric decay) is given by</p>
<p><span class="math display">\[
\beta_k = \beta\gamma^k
\]</span></p>
<p>Some constnat Beta, and a gamma raised to the power k. If gamam is 1/2, then the weights are beta when k=0, then a half beta, quarter beta, 1/8 beta, etc. If the weights decrease in this geometric pattern, we call this geometric decay.</p>
<p>For this case the model becomes</p>
<p><span class="math display">\[
y_t = \alpha + \beta(x_t + \gamma*X_{t-1}
\]</span></p>
<p>The backward shift operator B is defined by…
<span class="math display">\[
\]</span></p>
<p>If you operate with B3, you shift backwards 3 times… Let’s substitue the backwards shift operator into the expression. Then, for geometric decay, the model is …</p>
<p><span class="math display">\[
y_t = \alpha +\beta(1+\gamma\beta + \gamma^2\beta^2+...) \\
=\alpha+\beta(1-\gamma\beta)^{-1}x_t + \epsilon_t
\]</span></p>
<p>by use of the geometric series summation. Now multiply on both sides by the oeprator 1-<span class="math inline">\(\gamma\beta\)</span>. This yields</p>
<p><span class="math display">\[
y_t = (1-\gamma)\alpha + \gamma{y_{t-1}} + \beta{x_t} + \epsilon_t - \gamma\epsilon_{t-1}
\]</span>
or</p>
<p><span class="math display">\[
y_t = \alpha&#39; + \gamma{y_{t-1}} + \beta{x_t} + \epsilon&#39;_t
\]</span></p>
<p>when geometric decay prevails to define the Beta_k’s. When the betas decrease in a geometric fashion, then you can re-write the model in this way. Second term is the auto-regressive term. Only have contemporaenous x. Also has an altered error structure. The original error structure is just epsilon_t.</p>
<p>The lag one value of the DV appears on the right hand side as an explanatory variables, and the x variable appears only contemperaneously. The structure is first order auto-regressive structure. It is an arx model. Autoregressive becayse y is regressed back on itself, and the x denote the fact that there is an explanatory x variable. The epsilon is different from the original epsilon.</p>
<p>When geometric decay prevails, there is this simpler way to write the model.</p>
<p>Notes: the x’s have different lags. There is a lot of correlation. High degree of collinearity makes it difficult to interpret the beta coefficient. Consider a simpler formulation if geometric decay prevails.</p>
<p>Analysis: how to modify the data so that we can get reduction to white noise when we fit a model.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="distributed-lag-models.html#cb1-1" aria-hidden="true" tabindex="-1"></a>lydia <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/cloud/project/data/Lydia.txt&quot;</span>)</span>
<span id="cb1-2"><a href="distributed-lag-models.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(lydia)</span>
<span id="cb1-3"><a href="distributed-lag-models.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lydia)</span></code></pre></div>
<pre><code>##   year sales advrtsng advcopy Ind1 Ind2 Ind3 lagsales lag2sales lagadv
## 1 1907  1016      608       1    1    0    0       NA        NA     NA
## 2 1908   921      451       1    1    0    0     1016        NA    608
## 3 1909   934      529       1    1    0    0      921      1016    451
## 4 1910   976      543       1    1    0    0      934       921    529
## 5 1911   930      525       1    1    0    0      976       934    543
## 6 1912  1052      549       1    1    0    0      930       976    525</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="distributed-lag-models.html#cb3-1" aria-hidden="true" tabindex="-1"></a>sales<span class="ot">&lt;-</span> lydia<span class="sc">$</span>sales</span>
<span id="cb3-2"><a href="distributed-lag-models.html#cb3-2" aria-hidden="true" tabindex="-1"></a>ad<span class="ot">&lt;-</span> lydia<span class="sc">$</span>advrtsng</span>
<span id="cb3-3"><a href="distributed-lag-models.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ts</span>(sales,<span class="at">start=</span><span class="dv">1907</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4000</span>),</span>
<span id="cb3-4"><a href="distributed-lag-models.html#cb3-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;year&quot;</span>,<span class="at">main=</span><span class="st">&quot;Sales and</span></span>
<span id="cb3-5"><a href="distributed-lag-models.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">Advertising vs. Year&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb3-6"><a href="distributed-lag-models.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ts</span>(ad,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1907</span>,<span class="dv">1</span>)),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Sales and advertising series have similar traces. Advertising series appears to lag the sales series by perhaps a year in its pattern.</p>
<p>The model below is simply <span class="math display">\[sales_t = \alpha +\beta_1{advrtsng} +\epsilon_t\]</span>. Contemporaneous advertising is highly significant.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="distributed-lag-models.html#cb4-1" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span><span class="fu">lm</span>(sales<span class="sc">~</span>advrtsng);<span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ advrtsng)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -876.45 -222.95  -12.24  221.09  611.77 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 488.8327   127.4390   3.836  0.00034 ***
## advrtsng      1.4346     0.1269  11.308 1.26e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 343.5 on 52 degrees of freedom
## Multiple R-squared:  0.7109, Adjusted R-squared:  0.7053 
## F-statistic: 127.9 on 1 and 52 DF,  p-value: 1.259e-15</code></pre>
<p>Residual plot</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="distributed-lag-models.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ts</span>(<span class="fu">resid</span>(model1),<span class="at">start=</span><span class="dv">1907</span>),<span class="at">xlab=</span><span class="st">&quot;year&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;residual&quot;</span>,<span class="at">main=</span><span class="st">&quot;mo</span></span>
<span id="cb6-2"><a href="distributed-lag-models.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="st">del 1 residuals vs. year&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Adding a factor variable for advcopy.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="distributed-lag-models.html#cb7-1" aria-hidden="true" tabindex="-1"></a>fadvcopy<span class="ot">&lt;-</span><span class="fu">as.factor</span>(advcopy)</span>
<span id="cb7-2"><a href="distributed-lag-models.html#cb7-2" aria-hidden="true" tabindex="-1"></a>model2<span class="ot">&lt;-</span><span class="fu">lm</span>(sales<span class="sc">~</span>advrtsng<span class="sc">+</span>fadvcopy);<span class="fu">summary</span>(model2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ advrtsng + fadvcopy)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -606.08 -115.16   10.76  177.56  389.25 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 271.8320   107.9132   2.519 0.015082 *  
## advrtsng      1.3759     0.1098  12.533  &lt; 2e-16 ***
## fadvcopy2   583.3284   130.9357   4.455 4.87e-05 ***
## fadvcopy3    16.8703   128.6327   0.131 0.896193    
## fadvcopy4   400.5189   113.7859   3.520 0.000943 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 255.3 on 49 degrees of freedom
## Multiple R-squared:  0.8494, Adjusted R-squared:  0.8371 
## F-statistic: 69.11 on 4 and 49 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Same fit as before, just using dummy variables</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="distributed-lag-models.html#cb9-1" aria-hidden="true" tabindex="-1"></a> model3<span class="ot">&lt;-</span><span class="fu">lm</span>(sales<span class="sc">~</span>advrtsng<span class="sc">+</span>Ind1<span class="sc">+</span>Ind2<span class="sc">+</span>Ind3);<span class="fu">summary</span>(model3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ advrtsng + Ind1 + Ind2 + Ind3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -606.08 -115.16   10.76  177.56  389.25 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  672.3509   113.6994   5.913 3.18e-07 ***
## advrtsng       1.3759     0.1098  12.533  &lt; 2e-16 ***
## Ind1        -400.5189   113.7859  -3.520 0.000943 ***
## Ind2         182.8095    97.2061   1.881 0.065971 .  
## Ind3        -383.6485    90.5743  -4.236 1.00e-04 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 255.3 on 49 degrees of freedom
## Multiple R-squared:  0.8494, Adjusted R-squared:  0.8371 
## F-statistic: 69.11 on 4 and 49 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Goal is to reduce to white noise so that we explain as much autocorrelation as possible.</p>
<p>To what extend do sales depend on advertising from last year? Lag advertising by 2,3,4,5 years. Sales vs. advertising for 1 year is sig, 2 years is sig, 3, sig, 4 not sig. So, start with geometric decay model, and then add to the regression, advertising that is only contemporaenous. If geometric doesn’t work, add advertising only by 1 year, or by 2 years.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="distributed-lag-models.html#cb11-1" aria-hidden="true" tabindex="-1"></a>lag2adv<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fu">head</span>(advrtsng,<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb11-2"><a href="distributed-lag-models.html#cb11-2" aria-hidden="true" tabindex="-1"></a>lag3adv<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fu">head</span>(advrtsng,<span class="sc">-</span><span class="dv">3</span>))</span>
<span id="cb11-3"><a href="distributed-lag-models.html#cb11-3" aria-hidden="true" tabindex="-1"></a>lag4adv<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fu">head</span>(advrtsng,<span class="sc">-</span><span class="dv">4</span>))</span>
<span id="cb11-4"><a href="distributed-lag-models.html#cb11-4" aria-hidden="true" tabindex="-1"></a>lag5adv<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fu">head</span>(advrtsng,<span class="sc">-</span><span class="dv">5</span>))</span>
<span id="cb11-5"><a href="distributed-lag-models.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lagadv,sales)</span>
<span id="cb11-6"><a href="distributed-lag-models.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(sales<span class="sc">~</span>lagadv))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="distributed-lag-models.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lag2adv,sales)</span>
<span id="cb12-2"><a href="distributed-lag-models.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(sales<span class="sc">~</span>lag2adv))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="distributed-lag-models.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lag3adv,sales)</span>
<span id="cb13-2"><a href="distributed-lag-models.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(sales<span class="sc">~</span>lag3adv))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="distributed-lag-models.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lag4adv,sales)</span>
<span id="cb14-2"><a href="distributed-lag-models.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(sales<span class="sc">~</span>lag4adv))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-6-4.png" width="672" /></p>
<p>Fit a distributed lag model with geometric decay</p>
<p><span class="math display">\[
S_t = \alpha + \beta(A_t + \gamma{A_{t-1}} + \gamma^2{A_{t-2}} + \gamma^3{A_{t-3}}) + \epsilon_t \\
= \alpha +\beta(1-\gamma{\beta})^{-1}A_{t} + \epsilon_t
\]</span></p>
<p>where B is the backward shift operator. Recall that this formulation is equivalent to the autoregressive representation</p>
<p><span class="math display">\[
S_t = (1-\gamma)\alpha+\gamma{S_{t-1}} + \beta{A_t} + \epsilon_t - \gamma{\epsilon}_{t-1}
\]</span>
In model above, sales is regressed on sales 1 last year, plus contemporaenous advertising, plus the error term, and the different dummies for time regimes. Effect of advertising is the Beta coefficient. Want to measure the impact of advertising today and in the past on current sales. The effect of advertising in the same year, contemporaneously, is Beta. The effect of advertising on sales this year from the precious year is BetaXGamma. Effect of advertising from two years ago is Beta*Gamm squared. Effect of three years ago is BetaXGamma Q.</p>
<p>In this model the contemporaenous effect of advertising is <span class="math inline">\(\Beta\)</span>, the cumulative effect after one more time period is <span class="math inline">\(\beta(1+\gamma)\)</span>, and the cumulatibe effect after m-1 more time periods is</p>
<p><span class="math display">\[
\beta(1+\lambda + \lambda^2+...+\lambda^{m-1}) = \beta(1-\lambda^{m})/(1-\lambda)
\]</span></p>
<p>As m increases, this converged to <span class="math inline">\(\beta/(1-\lambda)\)</span>. Thus, the proportion fo the long-run cumulative effect of advertising upon sales realized after m time periods is <span class="math inline">\(1-\lambda^m\)</span>. Given p, the solution for m is</p>
<p><span class="math display">\[
m = log_e(1-p)/log_ey
\]</span></p>
<p>Model above is a way to measure long run effect of advertising when geometric decay prevails. From here, we can ask “how many time periods does it take to achieve 90% of this long term impact?” How far back in the past do we have to go to capture 90% of that impact? p = .9, if it is 90%.</p>
<p>The model below is</p>
<p><span class="math display">\[
S_t = \alpha+\beta_1{A_t} + \beta_2{S_{t-1}} + \beta_3{Ind1_t} + \beta_4{Ind2_t}
+ \beta_5{Ind3_t} + \epsilon_t
\]</span></p>
<p>So, fit a model with geometric decay. The error term is just epsilon. Put in dummy variables for the time regine. Sales regressed on advertising, and sales for the previous years.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="distributed-lag-models.html#cb15-1" aria-hidden="true" tabindex="-1"></a>lagsales<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="fu">head</span>(sales,<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb15-2"><a href="distributed-lag-models.html#cb15-2" aria-hidden="true" tabindex="-1"></a>lag2sales<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fu">head</span>(sales,<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb15-3"><a href="distributed-lag-models.html#cb15-3" aria-hidden="true" tabindex="-1"></a>model4<span class="ot">&lt;-</span><span class="fu">lm</span>(sales<span class="sc">~</span>lagsales<span class="sc">+</span>advrtsng<span class="sc">+</span>Ind1<span class="sc">+</span>Ind2<span class="sc">+</span>Ind3);<span class="fu">summary</span>(model4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ lagsales + advrtsng + Ind1 + Ind2 + Ind3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -371.39 -103.57  -30.79   88.24  389.88 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  254.63920   96.30805   2.644 0.011101 *  
## lagsales       0.60734    0.08142   7.459 1.65e-09 ***
## advrtsng       0.53450    0.13604   3.929 0.000278 ***
## Ind1        -133.34673   88.95563  -1.499 0.140555    
## Ind2         216.83964   67.21894   3.226 0.002288 ** 
## Ind3        -202.50459   67.05600  -3.020 0.004079 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 176.2 on 47 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.929,  Adjusted R-squared:  0.9215 
## F-statistic:   123 on 5 and 47 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Add lag two of sales as an explanatory variable</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="distributed-lag-models.html#cb17-1" aria-hidden="true" tabindex="-1"></a>model5<span class="ot">&lt;-</span></span>
<span id="cb17-2"><a href="distributed-lag-models.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(sales<span class="sc">~</span>lagsales<span class="sc">+</span>lag2sales<span class="sc">+</span>advrtsng<span class="sc">+</span>Ind1<span class="sc">+</span>Ind2<span class="sc">+</span>Ind3);<span class="fu">summary</span>(model5)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ lagsales + lag2sales + advrtsng + Ind1 + 
##     Ind2 + Ind3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -314.75  -97.10  -19.04   88.51  363.02 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  282.3863    95.4090   2.960   0.0049 ** 
## lagsales       0.8561     0.1489   5.748 7.38e-07 ***
## lag2sales     -0.2372     0.1207  -1.965   0.0556 .  
## advrtsng       0.4791     0.1362   3.519   0.0010 ** 
## Ind1        -139.5593    91.8130  -1.520   0.1355    
## Ind2         176.1334    69.0602   2.550   0.0142 *  
## Ind3        -160.2427    69.0219  -2.322   0.0248 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 172.5 on 45 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.9319, Adjusted R-squared:  0.9228 
## F-statistic: 102.7 on 6 and 45 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Fit another model. Add lag one advertising to the precious fit</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="distributed-lag-models.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">9</span>)</span>
<span id="cb19-2"><a href="distributed-lag-models.html#cb19-2" aria-hidden="true" tabindex="-1"></a>model6<span class="ot">&lt;-</span></span>
<span id="cb19-3"><a href="distributed-lag-models.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(sales<span class="sc">~</span>lagsales<span class="sc">+</span>lag2sales<span class="sc">+</span>advrtsng<span class="sc">+</span>lagadv<span class="sc">+</span>Ind1<span class="sc">+</span>Ind2<span class="sc">+</span>Ind3);<span class="fu">summary</span>(model6)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ lagsales + lag2sales + advrtsng + lagadv + 
##     Ind1 + Ind2 + Ind3)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -333.5635  -98.4101  -12.3733   85.5482  436.3308 
## 
## Coefficients:
##                Estimate  Std. Error  t value   Pr(&gt;|t|)    
## (Intercept)  259.860376   91.770977  2.83162 0.00695867 ** 
## lagsales       0.965412    0.150265  6.42475 8.0049e-08 ***
## lag2sales     -0.205023    0.116299 -1.76289 0.08486339 .  
## advrtsng       0.549964    0.133858  4.10856 0.00017055 ***
## lagadv        -0.344700    0.151048 -2.28206 0.02737726 *  
## Ind1        -116.556442   88.376485 -1.31886 0.19403832    
## Ind2         158.493912   66.492314  2.38364 0.02152282 *  
## Ind3         -88.371460   73.133545 -1.20836 0.23336410    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 164.995 on 44 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.939119,   Adjusted R-squared:  0.929433 
## F-statistic: 96.9603 on 7 and 44 DF,  p-value: &lt; 2.22e-16</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="distributed-lag-models.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ts</span>(<span class="fu">resid</span>(model6),<span class="at">start=</span><span class="fu">c</span>(<span class="dv">1907</span>,<span class="dv">1</span>)),<span class="at">xlab=</span><span class="st">&quot;year&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;residual&quot;</span>,<span class="at">main=</span><span class="st">&quot;model 6 residuals vs. year&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Calculate the 90% duration interval. Determine the first two deltas by hand calculation</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="distributed-lag-models.html#cb22-1" aria-hidden="true" tabindex="-1"></a>deltapartial<span class="ot">&lt;-</span>delta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">times=</span><span class="dv">500</span>))</span>
<span id="cb22-2"><a href="distributed-lag-models.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#deltapartial is the partial sum of the deltas</span></span>
<span id="cb22-3"><a href="distributed-lag-models.html#cb22-3" aria-hidden="true" tabindex="-1"></a>delta[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fl">0.549964</span>;delta[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fl">0.186242</span></span>
<span id="cb22-4"><a href="distributed-lag-models.html#cb22-4" aria-hidden="true" tabindex="-1"></a>deltapartial[<span class="dv">1</span>]<span class="ot">&lt;-</span>delta[<span class="dv">1</span>]</span>
<span id="cb22-5"><a href="distributed-lag-models.html#cb22-5" aria-hidden="true" tabindex="-1"></a>deltapartial[<span class="dv">2</span>]<span class="ot">&lt;-</span>deltapartial[<span class="dv">1</span>]<span class="sc">+</span>delta[<span class="dv">2</span>]</span>
<span id="cb22-6"><a href="distributed-lag-models.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">500</span>){</span>
<span id="cb22-7"><a href="distributed-lag-models.html#cb22-7" aria-hidden="true" tabindex="-1"></a>j1<span class="ot">&lt;-</span>j<span class="dv">-1</span>;j2<span class="ot">&lt;-</span>j<span class="dv">-2</span></span>
<span id="cb22-8"><a href="distributed-lag-models.html#cb22-8" aria-hidden="true" tabindex="-1"></a>delta[j]<span class="ot">&lt;-</span><span class="fl">0.965412</span><span class="sc">*</span>delta[j1]<span class="sc">-</span><span class="fl">0.205023</span><span class="sc">*</span>delta[j2]</span>
<span id="cb22-9"><a href="distributed-lag-models.html#cb22-9" aria-hidden="true" tabindex="-1"></a>deltapartial[j]<span class="ot">&lt;-</span>deltapartial[j1]<span class="sc">+</span>delta[j]</span>
<span id="cb22-10"><a href="distributed-lag-models.html#cb22-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-11"><a href="distributed-lag-models.html#cb22-11" aria-hidden="true" tabindex="-1"></a>deltapartial[<span class="dv">500</span>]<span class="sc">*</span><span class="fl">0.9</span></span></code></pre></div>
<pre><code>## [1] 0.770990227</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="distributed-lag-models.html#cb24-1" aria-hidden="true" tabindex="-1"></a>deltapartial[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span></code></pre></div>
<pre><code>##  [1] 0.549964000 0.736206000 0.803250993 0.829793139 0.841671481 0.847697224
##  [7] 0.851079215 0.853108814 0.854374827 0.855180937 0.855699604 0.856035059
## [13] 0.856252574 0.856393788 0.856485524 0.856545133 0.856583874 0.856609053
## [19] 0.856625418 0.856636055</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="rainfall.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="granger-causality.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/katjanewilson/Time-Series-Forecasting/edit/master/07-topic.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/katjanewilson/Time-Series-Forecasting/blob/master/07-topic.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
